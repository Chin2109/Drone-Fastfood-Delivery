<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Thêm món mới</title>
</head>
<body>
<h1>🍜 Thêm món mới</h1>

<form th:action="@{/restaurant/menu/add}" method="post">
  <label>Tên món:</label><br>
  <input type="text" name="name" required><br><br>

  <label>Mô tả:</label><br>
  <textarea name="description" rows="3" cols="40"></textarea><br><br>

  <label>Giá (VND):</label><br>
  <input type="number" name="price" min="0" required><br><br>

  <label>Phân loại (Category):</label><br>
  <select name="category.id" required>
    <option value="">-- Chọn loại --</option>
    <option th:each="cat : ${categories}"
            th:value="${cat.id}"
            th:text="${cat.name}">
    </option>
  </select><br><br>

  <label>Ảnh món ăn (URLs, phân tách bằng dấu phẩy):</label><br>
  <input type="text" name="images" placeholder="vd: https://img1.jpg, https://img2.jpg"><br><br>

  <label>Thuộc nhà hàng (Restaurant ID):</label><br>
  <input type="number" name="restaurantId" required><br><br>

  <label>Chay:</label>
  <input type="checkbox" name="vegetarian"><br>

  <label>Món theo mùa:</label>
  <input type="checkbox" name="seasonal"><br><br>

  <fieldset>
    <legend>Thành phần (Ingredients)</legend>
    <div id="ingredients">
      <div>
        <label>Tên nguyên liệu:</label>
        <input type="text" name="ingredients[0].name" required>
        <label>Loại:</label>
        <select name="ingredients[0].category.id">
          <option value="">-- Chọn --</option>
          <option th:each="ic : ${ingredientCategories}"
                  th:value="${ic.id}"
                  th:text="${ic.name}">
          </option>
        </select>
        <label>Còn hàng:</label>
        <input type="checkbox" name="ingredients[0].inStoke" checked>
      </div>
    </div>
    <button type="button" onclick="addIngredient()">+ Thêm nguyên liệu</button>
  </fieldset>

  <br><br>
  <button type="submit">✅ Lưu món</button>
  <a th:href="@{/restaurant/home}">Quay lại</a>
</form>

<script>
  let ingredientIndex = 1;
  function addIngredient() {
      const div = document.createElement('div');
      div.innerHTML = `
          <label>Tên nguyên liệu:</label>
          <input type="text" name="ingredients[${ingredientIndex}].name" required>
          <label>Loại:</label>
          <select name="ingredients[${ingredientIndex}].category.id">
              <option value="">-- Chọn --</option>
          </select>
          <label>Còn hàng:</label>
          <input type="checkbox" name="ingredients[${ingredientIndex}].inStoke" checked>
          <button type="button" onclick="this.parentElement.remove()">❌</button>
      `;
      document.getElementById('ingredients').appendChild(div);
      ingredientIndex++;
  }
</script>

</body>
</html>
